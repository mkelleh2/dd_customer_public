{"data":{"type":"notebooks","attributes":{"metadata":{"type":"runbook"},"name":"[WIP] [Implementation Services] Network Config Check","time":{"live_span":"1h"},"cells":[{"id":"rj0zewxp","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Network Config Check\n**Network Device Monitoring**\n- [ ] Decide NDM agent deployment - number of agents, what integrations are enabled on what agent, etc.\n- [ ] Reachability is available btw agent and devices\n- [ ] NDM Integration is configured via individual devices or autodiscovery\n- [ ] Ping integration is configured and sending data\n- [ ] Review discovered devices to confirm OOTB/generic profiles\n- [ ] Verify metrics from SNMP and NDM integrations\n- [ ] Device profiles are customized according to use case\n- [ ] Netflow monitoring is configured in the agent\n- [ ] (optional) Customize port enrichment for Netflow logs\n- [ ] Review the netflow data retention policy\n- [ ] Create netflow /network monitors for relevant use cases\n- [ ] Devices are showing as expected on the Network Devices page\n- [ ] OOTB dashboards are populating as expected\n- [ ] Devices are showing on the Network Device Topology Map\n\n\n**Cloud Network Monitoring**\n- [ ] Host is on a [supported platform](https://docs.datadoghq.com/network_monitoring/cloud_network_monitoring/setup/?tab=agentlinux#supported-platforms)\n- [ ] [network_config](https://docs.datadoghq.com/network_monitoring/cloud_network_monitoring/setup/?tab=agentlinux#supported-platforms:~:text=Edit-,/etc/datadog%2Dagent/system%2Dprobe.yaml,-to%20set%20the) set to true in `/etc/datadog-agent/system-probe.yaml`\n- [ ] (optional) enable resource collection for cloud integrations to allow Cloud Network Monitoring to discover cloud-managed entities for [enhanced resolution](https://docs.datadoghq.com/network_monitoring/cloud_network_monitoring/setup/?tab=agentlinux#enhanced-resolution)\n- [ ] For DNS Monitoring - you are using Agent v7.23+ for Linux OS, and v7.28+ for Windows Server, and CNM is configured\n- [ ] View key network metrics with the CNM Overview dashboard\n- [ ] Explore the CNM Search Page\n- [ ] Understand how to graph CNM data"}}},{"id":"xty1f3mz","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"# Network Config Check - NDM"}}},{"id":"hsrdo8jn","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Decide NDM agent deployment\n\n**Status:** Not Started\n\n**Recommendation: ** https://datadoghq.atlassian.net/wiki/spaces/TS/pages/4362404673/NDM+Agent+Planning+and+Design+considerations+in+Customer+Network\n- Add to SA workflow ... give them internal tool for this product that reflects this link ^"}}},{"id":"r1qe5g7c","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Reachability is available btw agent and devices\n- agent connectivity, network device reachability, UDP transport connectivity\n- Get sample devices and check via ping\n- [https://datadoghq.atlassian.net/wiki/spaces/TS/pages/2409398887/NDM+Field+Expedient+Troubleshooting+from+DD+agent+perspective](https://datadoghq.atlassian.net/wiki/spaces/TS/pages/2409398887/NDM+Field+Expedient+Troubleshooting+from+DD+agent+perspective#Validate-agent-connectivity-(to-Datadog-backend-and-target-IPs))\n- Check [NDM Troubleshooting Dashboard](/dash/integration/Datadog%20NDM%20Environment?fromUser=false&refresh_mode=sliding&from_ts=1738695552760&to_ts=1738699152760&live=true) as needed."}}},{"id":"khhf7atd","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## NDM Integration is configured via individual devices or autodiscovery\n- SNMP, API (software defined vendors), web crawler (ie. Meraki), (separate feature in NDM) netflow\n- Check [NDM Troubleshooting Dashboard](/dash/integration/Datadog%20NDM%20Environment?fromUser=false&refresh_mode=sliding&from_ts=1738695552760&to_ts=1738699152760&live=true) as needed."}}},{"id":"s69lxum3","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Ping integration is configured and sending data\nhttps://datadoghq.atlassian.net/wiki/spaces/II/pages/3291611892/Agent+Side+Ping+Configuration"}}},{"id":"xwinr71d","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Review discovered devices to confirm OOTB/generic profiles\n\nGroup by xxx tags [Example Search](/devices?detailsTab=metrics&facets=&groupBy=vendor%2Csnmp_device%2Csnmp_profile&hiddenColumns=ping_status%2Cvendor%2Clast_seen%2Csys_object_id%2Cmodel%2Cserial_number%2Clocation%2Cversion%2Cproduct_name%2Cos_name%2Cos_version%2Cos_hostname&page=1&showGraphs=true&sort=-status&tab=graph)\n- Can also be seen in the SNMP section of the [NDM Troubleshooting Dashboard](https://app.datadoghq.com/dash/integration/Datadog%20NDM%20Environment?fromUser=false\\&refresh_mode=sliding\\&from_ts=1738695552760\\&to_ts=1738699152760\\&live=true) in the tables (column name = snmp_profile)\n\n     as needed.\n\nUse this list to understand what SNMP profiles are being applied to the devices discovered through SNMP."}}},{"id":"9o6b3sq7","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Verify metrics from SNMP and NDM integrations\n- Use the metrics summary page to search by snmp_profile ([example](/metric/summary?tags=snmp_profile%3Ajuniper))"}}},{"id":"ogbvjb0e","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Device profiles are customized according to use case\n- Is there a MIB we support or not?\n- What devices are missing gaps in observability compared to OOTB profiles? What OIDs are aligned?\n\nUse cases: \n1. Datadog doesn't have an OOTB profile. \n2. You have OOTB profile, but don't have specific OID they want.\n3. Too much data - want to collect less or be more targeted in what they observe.\n\nFollow up Qs:\n- Does this device support SNMP? \n- How do we identify the SNMP MIB? \n- what OIDs are needed"}}},{"id":"qfkreeve","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Netflow monitoring is configured in the agent\n\n- https://docs.datadoghq.com/network_monitoring/netflow/#configuration\n- <https://www.datadoghq.com/blog/monitor-netflow-with-datadog/>"}}},{"id":"ho59gwfj","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## (optional) Customize port enrichment for Netflow logs"}}},{"id":"fwavvi1p","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Review the netflow data retention policy\n- https://docs.datadoghq.com/developers/guide/data-collection-resolution-retention/#:~:text=15%20months-,Infrastructure,-NetFlow%20Monitoring"}}},{"id":"i5ed3t6l","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Create netflow /network monitors for relevant use cases\n-<https://docs.datadoghq.com/monitors/types/netflow/>"}}},{"id":"evz2gltd","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Devices are showing as expected on the Network Devices page"}}},{"id":"acukr2x5","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## OOTB dashboards are populating as expected"}}},{"id":"mrrwktag","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Devices are showing on the Network Device Topology Map\n- Tag strategy may need to be updated if you cannot group by a particular tag key value that you are interested in (ie. datacenter, location, etc)"}}},{"id":"ej6yoxw9","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"---\n\n"}}},{"id":"bumrjomf","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"# Network Config Check - CNM"}}},{"id":"dx2q3jn4","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Explore the CNM Search Page\n\n- https://docs.datadoghq.com/network_monitoring/cloud_network_monitoring/guide/detecting_application_availability/\n- <https://www.datadoghq.com/blog/cnm-best-practices/>"}}},{"id":"ve5j9h4s","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## Understand how to graph CNM data\n- [Use this notebook template](/notebook/template/10/understanding-graphing-network-metrics)"}}},{"id":"8vdxchpr","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"---"}}},{"id":"lntng146","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"# Cloud Network Monitoring\n\nDatadog Cloud Network Monitoring (CNM) gives you visibility into your network traffic between services, containers, availability zones, and any other tag in Datadog. Connection data at the IP, port, and PID levels is aggregated into application-layer dependencies between meaningful client and server endpoints, which can be analyzed and visualized through a customizable [network page](https://app.datadoghq.com/network) and [network map](https://app.datadoghq.com/network/map).\n\nCloud Network Monitoring **requires** [Datadog Agent v6.14+](https://app.datadoghq.com/account/settings/agent/latest). Because metrics are automatically collected in higher versions of the Agent, see the [metrics setup section](https://docs.datadoghq.com/network_monitoring/dns/#setup) to configure DNS Monitoring.\n\n\n## Network Analytics + Map\n\n![](https://datadog-docs.imgix.net/images/network_performance_monitoring/network_analytics/network_diagram_with_tags.dbf9a99fde1da56a16a1de5fd1282643.png?fit=max&auto=format&w=1900&h=1035)\n\nTo refine your search to traffic between particular endpoints, aggregate and filter your network connections **with tags**. Tags from Datadog integrations or [Unified Service Tagging](https://docs.datadoghq.com/getting_started/tagging/unified_service_tagging/) can be used for aggregating and filtering automatically. When utilizing tagging in Network Monitoring, you can take advantage of how network traffic flows across availability zones for a particular service or for your entire infrastructure. Grouping by `client` and `server` tags visualizes the network flow _between_ those two sets of tags. ([source](https://docs.datadoghq.com/network_monitoring/cloud_network_monitoring/network_analytics/?tab=loadbalancers#queries))\n\n### Example(s)\n- Analytics Page: [Host to S3 Bucket](network?query=&clientService=&cols=sent_vol%2Csent_pkt%2Crcvd_vol%2Crcvd_pkt%2Ctcp_r%2Crtt%2Ctcp_l%2Ctcp_e&destG=tag_server_s3_bucket&env=%2A&filter_from=1&filter_to=8164103&netviz=sent_vol%3A%3A%2Ctcp_r_pct%3A%3A%2Crtt%3A%3A&refresh_mode=paused&serverService=azure.files&showGraphs=true&showRQ=true&srcG=core_network.client.host&from_ts=1738020859733&to_ts=1738021759733&live=true)\n- Analytics Page: [Port to Port](/network?cols=sent_vol%2Csent_pkt%2Crcvd_vol%2Crcvd_pkt%2Ctcp_r%2Crtt%2Ctcp_l%2Ctcp_e&destG=core_network.server.port&env=%2A&netviz=sent_vol%3A%3A%2Ctcp_r_pct%3A%3A%2Crtt%3A%3A&refresh_mode=sliding&showGraphs=true&showRQ=true&srcG=core_network.client.port&from_ts=1738023224644&to_ts=1738024124644&live=true)\n- Analytics Page: [Host to Service](network?query=&clientService=&cols=sent_vol%2Csent_pkt%2Crcvd_vol%2Crcvd_pkt%2Ctcp_r%2Crtt%2Ctcp_l%2Ctcp_e&destG=tag_server_service&env=%2A&filter_from=1&filter_to=8164103&netviz=sent_vol%3A%3A%2Ctcp_r_pct%3A%3A%2Crtt%3A%3A&refresh_mode=paused&serverService=azure.files&showGraphs=true&showRQ=true&srcG=core_network.client.host&from_ts=1738020859733&to_ts=1738021759733&live=true)\n- Network Map: [Traffic by Env](network/map?clientService=&destG=core_network.server.auto_grouping_tags&env=%2A&filter_from=22693&filter_to=2177728480&highlight=true&netviz=sent_vol%3A%3A%2Ctcp_r_pct%3A%3A%2Crtt%3A%3A&refresh_mode=paused&serverService=azure.files&srcG=tag_client_env&from_ts=1738020859733&to_ts=1738021759733&live=false)\n- Network Map: [Traffic going to a particular host](/network/map?query=%28network.client.host%3ACU-DMSQL01%20OR%20network.server.host%3ACU-DMSQL01%29&clientService=&destG=core_network.server.auto_grouping_tags&env=%2A&filter_from=1&filter_to=8164103&highlight=true&netviz=sent_vol%3A%3A%2Ctcp_r_pct%3A%3A%2Crtt%3A%3A&refresh_mode=paused&serverService=azure.files&srcG=core_network.client.host&from_ts=1738020859733&to_ts=1738021759733&live=false)\n\n\n> **Go beyond the Network Page...** Data correlation is key when investigating issues. Being able to go from a service trace and select the **Network** tab to quickly confirm or disqualify if a service latency issue is directly related to a network outage, cpu utilization for a process on the host, database bottleneck, etc. can greatly accelerate MTTR. [Example here](/apm/entity/service%3Aswjobengineworker2x64?dependencyMap=qson%3A%28data%3A%28telemetrySelection%3Aall_sources%29%2Cversion%3A%210%29&deployments=qson%3A%28data%3A%28hits%3A%28selected%3Aversion_count%29%2Cerrors%3A%28selected%3Aversion_count%29%2Clatency%3A%28selected%3Ap95%29%2CtopN%3A%215%29%2Cversion%3A%210%29&env=uat&fromUser=false&graphType=service_map&groupMapByOperation=null&netviz=sent_vol%3A%3A%2Ctcp_r_pct%3A%3A%2Crtt%3A%3A&operationName=wcf.request&panels=qson%3A%28data%3A%28activePanelKey%3Atrace%2Ctrace%3A%28traceID%3A67982a2e00000000d7b791dd8e36d8ae%2CspanID%3A7468320836627635534%29%29%2Cversion%3A%210%29&resources=qson%3A%28data%3A%28visible%3A%21t%2Chits%3A%28selected%3Atotal%29%2Cerrors%3A%28selected%3Atotal%29%2Clatency%3A%28selected%3Ap95%29%2CtopN%3A%215%29%2Cversion%3A%211%29&shouldShowLegend=true&spanID=7468320836627635534&spanViewType=networks&summary=qson%3A%28data%3A%28visible%3A%21t%2Cchanges%3A%28%29%2Cerrors%3A%28selected%3Acount%29%2Chits%3A%28selected%3Acount%29%2Clatency%3A%28selected%3Alatency%2Cslot%3A%28agg%3A95%29%2Cdistribution%3A%28isLogScale%3A%21f%29%2CshowTraceOutliers%3A%21t%29%2Csublayer%3A%28slot%3A%28layers%3AserviceAndInferred%29%2Cselected%3Apercentage%29%2ClagMetrics%3A%28selectedMetric%3A%21s%2CselectedGroupBy%3A%21s%29%29%2Cversion%3A%211%29&timeHint=1738025518259&trace=AwAAAZSqZMSzyG9yFwAAABhBWlNxWk5SYUFBQTVXejRPaEFvckZMZlgAAAAkMDE5NGFhNjQtZmYwOS00NmM4LTkzNzAtMmU0YTFlMDFjNWIyAAABKQ&traceID=67982a2e00000000d7b791dd8e36d8ae&traces=qson%3A%28data%3A%28%29%2Cversion%3A%210%29&start=1738021864309&end=1738025464309&paused=false#traces)."}}},{"id":"0bqblj8e","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"## DNS Page\n\nUse the search bar at the top of the page to query for dependencies between a client (which makes the DNS request) and a DNS server (which responds to the DNS request). The destination port is automatically scoped to DNS port 53 so that all resulting dependencies match this (client → DNS server) format.\n\nConfigure your server display with one of the following options from the **Group by** dropdown menu:\n\n-   `dns_server`: The server receiving DNS requests. This tag has the same value as `pod_name` or `task_name`. If those tags are not available, `host_name` is used.\n-   `host`: The host name of the DNS server.\n-   `service`: The service running on the DNS server.\n-   `IP`: The IP of the DNS server.\n-   `dns_query`: (Requires Agent version 7.33 or later) The domain that was queried.\n\n#### DNS Metrics\n\nData collected list can be found [here](https://docs.datadoghq.com/network_monitoring/dns/#metrics).\n\n**Note**: Data is collected every 30 seconds, aggregated in five minute buckets, and retained for 14 days.\n\n#### Example(s)\n- [Frequently resolved domains](network/dns?destG=core_network.dns_query&env=%2A&netviz=req_q%3A%3Achange&recQD=freq-domains&refresh_mode=sliding&showGraphs=true&showRQD=true&srcG=core_network.client.auto_grouping_tags&from_ts=1737852828977&to_ts=1738025628977&live=true)\n- [Host to DNS IP](network/dns?destG=core_network.server.ip&env=%2A&netviz=req_q%3A%3A%2Cerr_t%3A%3A%2Cres_t%3A%3A&refresh_mode=sliding&showGraphs=true&showRQD=true&srcG=core_network.client.host&from_ts=1737852828977&to_ts=1738025628977&live=true)\n\n\n"}}},{"id":"3rg5o4io","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"# Network Device Monitoring\n\n[NDM Glossary](https://docs.datadoghq.com/network_monitoring/devices/glossary)\n\n![](https://datadog-docs.imgix.net/images/network_device_monitoring/snmp/snmp_device_polling.3266cd75a1dcae76710170b9107f2067.png?fit=max&auto=format)\n\n**Validation**: [Run the Agent’s status subcommand](https://docs.datadoghq.com/agent/configuration/agent-commands/#agent-status-and-information) and look for `snmp` under the Checks section\n\nNetwork Device Monitoring uses profiles to tell the Datadog Agent the metrics and associated tags to collect. A profile is a collection of OIDs associated with a device.\n\nBy default, all profiles in the Agent configuration directory are loaded. To customize the specific profiles for collection, explicitly reference them by filename under `definition_file`, or provide an inline list under `definition`.\n\n**Note**: The generic profile is [generic-device.yaml](https://github.com/DataDog/integrations-core/blob/master/snmp/datadog_checks/snmp/data/default_profiles/generic-device.yaml), which supports routers, switches, and other devices.\n\n#### Data Collected\n\nSee the [SNMP Metrics Reference](https://docs.datadoghq.com/network_monitoring/devices/data/) for all OOTB metrics related to NDM. \n\nNetwork Device Monitoring submits specified metrics under the `snmp.*` namespace. The metrics collected are determined by the `[configured profile]`. If the metrics you want are not on the following list, search for the OID and its name from the [Global OID reference database](http://oidref.com/) to add to your profiles.\n\nSee [this guide](https://docs.datadoghq.com/network_monitoring/devices/guide/build-ndm-profile/) to build a custom NDM profile for advanced use cases."}}},{"id":"2rwcb46s","type":"notebook_cells","attributes":{"definition":{"type":"markdown","text":"---\n## Additional Resources\n- Use the [Network API](https://docs.datadoghq.com/api/latest/network-device-monitoring/) to extract the following information about your network devices:\n  -  [Get the list of interfaces for your devices.](https://docs.datadoghq.com/api/latest/network-device-monitoring/#get-the-list-of-interfaces-of-the-device)\n  -  [Get the list of tags for your devices.](https://docs.datadoghq.com/api/latest/network-device-monitoring/#get-the-list-of-tags-for-a-device)\n  -  [Update the list of tags for your devices.](https://docs.datadoghq.com/api/latest/network-device-monitoring/#update-the-tags-for-a-device)\n- Network Device [Troubleshooting](https://docs.datadoghq.com/network_monitoring/devices/troubleshooting)\n- [Blog: Monitor DNS with Datadog](https://www.datadoghq.com/blog/monitor-dns-with-datadog/)"}}}],"template_variables":[],"schema_version":0}}}
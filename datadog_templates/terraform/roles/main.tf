data "datadog_permissions" "rbac" {}

locals {
  roles = {
    "developer-tf" = [
      data.datadog_permissions.rbac.permissions.ddsql_editor_read,
      data.datadog_permissions.rbac.permissions.agent_flare_collection,
      data.datadog_permissions.rbac.permissions.observability_pipelines_read,
      data.datadog_permissions.rbac.permissions.debugger_read,
      data.datadog_permissions.rbac.permissions.teams_manage,
      data.datadog_permissions.rbac.permissions.standard,
      data.datadog_permissions.rbac.permissions.logs_live_tail,
      data.datadog_permissions.rbac.permissions.logs_read_archives,
      data.datadog_permissions.rbac.permissions.logs_read_data,
      data.datadog_permissions.rbac.permissions.logs_read_index_data,
      data.datadog_permissions.rbac.permissions.logs_write_facets,
      data.datadog_permissions.rbac.permissions.logs_write_exclusion_filters,
      data.datadog_permissions.rbac.permissions.logs_write_pipelines,
      data.datadog_permissions.rbac.permissions.logs_write_processors,
      data.datadog_permissions.rbac.permissions.logs_generate_metrics,
      data.datadog_permissions.rbac.permissions.logs_write_historical_view,
      data.datadog_permissions.rbac.permissions.dashboards_write,
      data.datadog_permissions.rbac.permissions.dashboards_public_share,
      data.datadog_permissions.rbac.permissions.generate_dashboard_reports,
      data.datadog_permissions.rbac.permissions.monitors_write,
      data.datadog_permissions.rbac.permissions.monitors_downtime,
      data.datadog_permissions.rbac.permissions.metric_tags_write,
      data.datadog_permissions.rbac.permissions.integrations_api,
      data.datadog_permissions.rbac.permissions.apm_retention_filter_read,
      data.datadog_permissions.rbac.permissions.apm_service_ingest_read,
      data.datadog_permissions.rbac.permissions.apm_generate_metrics,
      data.datadog_permissions.rbac.permissions.apm_remote_configuration_read,
      data.datadog_permissions.rbac.permissions.rum_apps_write,
      data.datadog_permissions.rbac.permissions.synthetics_global_variable_read,
      data.datadog_permissions.rbac.permissions.synthetics_private_location_read,
      data.datadog_permissions.rbac.permissions.synthetics_read,
      data.datadog_permissions.rbac.permissions.synthetics_default_settings_read,
      data.datadog_permissions.rbac.permissions.synthetics_global_variable_write,
      data.datadog_permissions.rbac.permissions.synthetics_write,
      data.datadog_permissions.rbac.permissions.synthetics_default_settings_write,
      data.datadog_permissions.rbac.permissions.incident_settings_read,
      data.datadog_permissions.rbac.permissions.incident_settings_write,
      data.datadog_permissions.rbac.permissions.incident_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_signals_read,
      data.datadog_permissions.rbac.permissions.rum_session_replay_read,
      data.datadog_permissions.rbac.permissions.rum_generate_metrics,
      data.datadog_permissions.rbac.permissions.apm_pipelines_read,
      data.datadog_permissions.rbac.permissions.notebooks_write,
      data.datadog_permissions.rbac.permissions.slos_corrections,
      data.datadog_permissions.rbac.permissions.slos_write,
      data.datadog_permissions.rbac.permissions.apm_service_catalog_read,
      data.datadog_permissions.rbac.permissions.watchdog_insights_read,
      data.datadog_permissions.rbac.permissions.connections_resolve,
      data.datadog_permissions.rbac.permissions.manage_integrations,
      data.datadog_permissions.rbac.permissions.appsec_event_rule_read,
      data.datadog_permissions.rbac.permissions.connections_read,
      data.datadog_permissions.rbac.permissions.connections_write,
      data.datadog_permissions.rbac.permissions.workflows_read,
      data.datadog_permissions.rbac.permissions.workflows_run,
      data.datadog_permissions.rbac.permissions.workflows_write,
      data.datadog_permissions.rbac.permissions.appsec_activation_read,
      data.datadog_permissions.rbac.permissions.appsec_protect_read,
      data.datadog_permissions.rbac.permissions.security_monitoring_cws_agent_rules_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_cws_agent_rules_read,
      data.datadog_permissions.rbac.permissions.continuous_profiler_read,
      data.datadog_permissions.rbac.permissions.cases_write,
      data.datadog_permissions.rbac.permissions.cases_read,
      data.datadog_permissions.rbac.permissions.intelligent_test_runner_settings_write,
      data.datadog_permissions.rbac.permissions.ci_visibility_write,
      data.datadog_permissions.rbac.permissions.ci_visibility_settings_write,
      data.datadog_permissions.rbac.permissions.incident_notification_settings_read,
      data.datadog_permissions.rbac.permissions.incident_notification_settings_write,
      data.datadog_permissions.rbac.permissions.client_tokens_read,
      data.datadog_permissions.rbac.permissions.client_tokens_write,
      data.datadog_permissions.rbac.permissions.event_config_write,
      data.datadog_permissions.rbac.permissions.saved_views_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_findings_write,
      data.datadog_permissions.rbac.permissions.ci_visibility_pipelines_write,
      data.datadog_permissions.rbac.permissions.host_tags_write,
      data.datadog_permissions.rbac.permissions.watchdog_alerts_write,
      data.datadog_permissions.rbac.permissions.cloud_cost_management_read,
      data.datadog_permissions.rbac.permissions.quality_gate_rules_read,
      data.datadog_permissions.rbac.permissions.metrics_metadata_write,
      data.datadog_permissions.rbac.permissions.processes_generate_metrics,
      data.datadog_permissions.rbac.permissions.facets_write,
      data.datadog_permissions.rbac.permissions.rum_playlist_write,
      data.datadog_permissions.rbac.permissions.event_correlation_config_read,
      data.datadog_permissions.rbac.permissions.event_correlation_config_write,
      data.datadog_permissions.rbac.permissions.apps_run,
      data.datadog_permissions.rbac.permissions.apps_write,
      data.datadog_permissions.rbac.permissions.integrations_read,
      data.datadog_permissions.rbac.permissions.dora_settings_write,
      data.datadog_permissions.rbac.permissions.containers_generate_image_metrics,
      data.datadog_permissions.rbac.permissions.apm_api_catalog_read,
      data.datadog_permissions.rbac.permissions.apm_api_catalog_write,
      data.datadog_permissions.rbac.permissions.continuous_profiler_pgo_read,
      data.datadog_permissions.rbac.permissions.reference_tables_read,
      data.datadog_permissions.rbac.permissions.code_analysis_read,
      data.datadog_permissions.rbac.permissions.on_prem_runner_read,
      data.datadog_permissions.rbac.permissions.on_prem_runner_use,
      data.datadog_permissions.rbac.permissions.aws_configuration_read,
      data.datadog_permissions.rbac.permissions.azure_configuration_read,
      data.datadog_permissions.rbac.permissions.gcp_configuration_read,
      data.datadog_permissions.rbac.permissions.oci_configuration_read,
      data.datadog_permissions.rbac.permissions.quality_gates_evaluations_read,
    ]
    "admin-tf" = [
      data.datadog_permissions.rbac.permissions.ddsql_editor_read,
      data.datadog_permissions.rbac.permissions.incidents_private_global_access,
      data.datadog_permissions.rbac.permissions.observability_pipelines_read,
      data.datadog_permissions.rbac.permissions.observability_pipelines_write,
      data.datadog_permissions.rbac.permissions.observability_pipelines_delete,
      data.datadog_permissions.rbac.permissions.observability_pipelines_deploy,
      data.datadog_permissions.rbac.permissions.generate_dashboard_reports,
      data.datadog_permissions.rbac.permissions.apm_remote_configuration_write,
      data.datadog_permissions.rbac.permissions.debugger_write,
      data.datadog_permissions.rbac.permissions.debugger_read,
      data.datadog_permissions.rbac.permissions.debugger_capture_variables,
      data.datadog_permissions.rbac.permissions.security_pipelines_read,
      data.datadog_permissions.rbac.permissions.security_pipelines_write,
      data.datadog_permissions.rbac.permissions.admin,
      data.datadog_permissions.rbac.permissions.logs_modify_indexes,
      data.datadog_permissions.rbac.permissions.logs_live_tail,
      data.datadog_permissions.rbac.permissions.logs_write_pipelines,
      data.datadog_permissions.rbac.permissions.logs_write_archives,
      data.datadog_permissions.rbac.permissions.logs_read_archives,
      data.datadog_permissions.rbac.permissions.logs_generate_metrics,
      data.datadog_permissions.rbac.permissions.logs_read_data,
      data.datadog_permissions.rbac.permissions.logs_write_historical_view,
      data.datadog_permissions.rbac.permissions.logs_write_facets,
      data.datadog_permissions.rbac.permissions.dashboards_write,
      data.datadog_permissions.rbac.permissions.dashboards_public_share,
      data.datadog_permissions.rbac.permissions.monitors_write,
      data.datadog_permissions.rbac.permissions.monitors_downtime,
      data.datadog_permissions.rbac.permissions.security_monitoring_rules_read,
      data.datadog_permissions.rbac.permissions.security_monitoring_rules_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_signals_read,
      data.datadog_permissions.rbac.permissions.user_access_invite,
      data.datadog_permissions.rbac.permissions.user_access_manage,
      data.datadog_permissions.rbac.permissions.user_app_keys,
      data.datadog_permissions.rbac.permissions.api_keys_read,
      data.datadog_permissions.rbac.permissions.api_keys_write,
      data.datadog_permissions.rbac.permissions.api_keys_delete,
      data.datadog_permissions.rbac.permissions.org_app_keys_read,
      data.datadog_permissions.rbac.permissions.org_app_keys_write,
      data.datadog_permissions.rbac.permissions.apm_retention_filter_read,
      data.datadog_permissions.rbac.permissions.apm_retention_filter_write,
      data.datadog_permissions.rbac.permissions.apm_service_ingest_read,
      data.datadog_permissions.rbac.permissions.apm_service_ingest_write,
      data.datadog_permissions.rbac.permissions.apm_apdex_manage_write,
      data.datadog_permissions.rbac.permissions.apm_generate_metrics,
      data.datadog_permissions.rbac.permissions.apm_primary_operation_write,
      data.datadog_permissions.rbac.permissions.apm_tag_management_write,
      data.datadog_permissions.rbac.permissions.rum_apps_write,
      data.datadog_permissions.rbac.permissions.rum_retention_filters_read,
      data.datadog_permissions.rbac.permissions.rum_retention_filters_write,
      data.datadog_permissions.rbac.permissions.metric_tags_write,
      data.datadog_permissions.rbac.permissions.integrations_api,
      data.datadog_permissions.rbac.permissions.logs_read_index_data,
      data.datadog_permissions.rbac.permissions.logs_write_pipelines,
      data.datadog_permissions.rbac.permissions.logs_write_exclusion_filters,
      data.datadog_permissions.rbac.permissions.logs_write_processors,
      data.datadog_permissions.rbac.permissions.synthetics_global_variable_read,
      data.datadog_permissions.rbac.permissions.synthetics_private_location_read,
      data.datadog_permissions.rbac.permissions.synthetics_private_location_write,
      data.datadog_permissions.rbac.permissions.billing_read,
      data.datadog_permissions.rbac.permissions.billing_edit,
      data.datadog_permissions.rbac.permissions.usage_read,
      data.datadog_permissions.rbac.permissions.usage_edit,
      data.datadog_permissions.rbac.permissions.synthetics_global_variable_write,
      data.datadog_permissions.rbac.permissions.synthetics_read,
      data.datadog_permissions.rbac.permissions.synthetics_write,
      data.datadog_permissions.rbac.permissions.synthetics_default_settings_read,
      data.datadog_permissions.rbac.permissions.synthetics_default_settings_write,
      data.datadog_permissions.rbac.permissions.data_scanner_read,
      data.datadog_permissions.rbac.permissions.data_scanner_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_filters_read,
      data.datadog_permissions.rbac.permissions.security_monitoring_filters_write,
      data.datadog_permissions.rbac.permissions.incident_settings_read,
      data.datadog_permissions.rbac.permissions.incident_settings_write,
      data.datadog_permissions.rbac.permissions.incident_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_signals_write,
      data.datadog_permissions.rbac.permissions.appsec_event_rule_write,
      data.datadog_permissions.rbac.permissions.rum_session_replay_read,
      data.datadog_permissions.rbac.permissions.rum_generate_metrics,
      data.datadog_permissions.rbac.permissions.audit_logs_write,
      data.datadog_permissions.rbac.permissions.audit_logs_read,
      data.datadog_permissions.rbac.permissions.service_account_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_notification_profiles_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_notification_profiles_read,
      data.datadog_permissions.rbac.permissions.standard,
      data.datadog_permissions.rbac.permissions.apm_pipelines_read,
      data.datadog_permissions.rbac.permissions.apm_pipelines_write,
      data.datadog_permissions.rbac.permissions.notebooks_write,
      data.datadog_permissions.rbac.permissions.usage_notifications_read,
      data.datadog_permissions.rbac.permissions.usage_notifications_write,
      data.datadog_permissions.rbac.permissions.slos_corrections,
      data.datadog_permissions.rbac.permissions.slos_write,
      data.datadog_permissions.rbac.permissions.apm_service_catalog_read,
      data.datadog_permissions.rbac.permissions.apm_service_catalog_write,
      data.datadog_permissions.rbac.permissions.watchdog_insights_read,
      data.datadog_permissions.rbac.permissions.org_management,
      data.datadog_permissions.rbac.permissions.logs_write_forwarding_rules,
      data.datadog_permissions.rbac.permissions.connections_resolve,
      data.datadog_permissions.rbac.permissions.manage_integrations,
      data.datadog_permissions.rbac.permissions.appsec_event_rule_read,
      data.datadog_permissions.rbac.permissions.logs_delete_data,
      data.datadog_permissions.rbac.permissions.connections_read,
      data.datadog_permissions.rbac.permissions.connections_write,
      data.datadog_permissions.rbac.permissions.workflows_read,
      data.datadog_permissions.rbac.permissions.workflows_run,
      data.datadog_permissions.rbac.permissions.workflows_write,
      data.datadog_permissions.rbac.permissions.appsec_activation_read,
      data.datadog_permissions.rbac.permissions.appsec_activation_write,
      data.datadog_permissions.rbac.permissions.appsec_protect_read,
      data.datadog_permissions.rbac.permissions.appsec_protect_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_cws_agent_rules_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_cws_agent_rules_read,
      data.datadog_permissions.rbac.permissions.continuous_profiler_read,
      data.datadog_permissions.rbac.permissions.cases_write,
      data.datadog_permissions.rbac.permissions.cases_read,
      data.datadog_permissions.rbac.permissions.intelligent_test_runner_settings_write,
      data.datadog_permissions.rbac.permissions.intelligent_test_runner_activation_write,
      data.datadog_permissions.rbac.permissions.ci_visibility_write,
      data.datadog_permissions.rbac.permissions.ci_visibility_settings_write,
      data.datadog_permissions.rbac.permissions.ci_provider_settings_write,
      data.datadog_permissions.rbac.permissions.monitor_config_policy_write,
      data.datadog_permissions.rbac.permissions.incident_notification_settings_read,
      data.datadog_permissions.rbac.permissions.incident_notification_settings_write,
      data.datadog_permissions.rbac.permissions.teams_manage,
      data.datadog_permissions.rbac.permissions.apm_remote_configuration_read,
      data.datadog_permissions.rbac.permissions.ci_ingestion_control_write,
      data.datadog_permissions.rbac.permissions.client_tokens_read,
      data.datadog_permissions.rbac.permissions.client_tokens_write,
      data.datadog_permissions.rbac.permissions.error_tracking_write,
      data.datadog_permissions.rbac.permissions.event_config_write,
      data.datadog_permissions.rbac.permissions.saved_views_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_findings_write,
      data.datadog_permissions.rbac.permissions.ci_visibility_pipelines_write,
      data.datadog_permissions.rbac.permissions.host_tags_write,
      data.datadog_permissions.rbac.permissions.watchdog_alerts_write,
      data.datadog_permissions.rbac.permissions.cloud_cost_management_read,
      data.datadog_permissions.rbac.permissions.cloud_cost_management_write,
      data.datadog_permissions.rbac.permissions.reference_tables_write,
      data.datadog_permissions.rbac.permissions.rum_delete_data,
      data.datadog_permissions.rbac.permissions.quality_gate_rules_read,
      data.datadog_permissions.rbac.permissions.quality_gate_rules_write,
      data.datadog_permissions.rbac.permissions.appsec_vm_write,
      data.datadog_permissions.rbac.permissions.metrics_metadata_write,
      data.datadog_permissions.rbac.permissions.processes_generate_metrics,
      data.datadog_permissions.rbac.permissions.facets_write,
      data.datadog_permissions.rbac.permissions.rum_playlist_write,
      data.datadog_permissions.rbac.permissions.event_correlation_config_read,
      data.datadog_permissions.rbac.permissions.event_correlation_config_write,
      data.datadog_permissions.rbac.permissions.static_analysis_settings_write,
      data.datadog_permissions.rbac.permissions.security_monitoring_suppressions_read,
      data.datadog_permissions.rbac.permissions.security_monitoring_suppressions_write,
      data.datadog_permissions.rbac.permissions.error_tracking_exclusion_filters_write,
      data.datadog_permissions.rbac.permissions.error_tracking_settings_write,
      data.datadog_permissions.rbac.permissions.ndm_netflow_port_mappings_write,
      data.datadog_permissions.rbac.permissions.apps_run,
      data.datadog_permissions.rbac.permissions.apps_write,
      data.datadog_permissions.rbac.permissions.integrations_read,
      data.datadog_permissions.rbac.permissions.rum_extend_retention,
      data.datadog_permissions.rbac.permissions.dora_settings_write,
      data.datadog_permissions.rbac.permissions.containers_generate_image_metrics,
      data.datadog_permissions.rbac.permissions.apm_api_catalog_read,
      data.datadog_permissions.rbac.permissions.apm_api_catalog_write,
      data.datadog_permissions.rbac.permissions.continuous_profiler_pgo_read,
      data.datadog_permissions.rbac.permissions.flex_logs_config_write,
      data.datadog_permissions.rbac.permissions.org_connections_read,
      data.datadog_permissions.rbac.permissions.org_connections_write,
      data.datadog_permissions.rbac.permissions.reference_tables_read,
      data.datadog_permissions.rbac.permissions.fleet_policies_write,
      data.datadog_permissions.rbac.permissions.orchestration_custom_resource_definitions_write,
      data.datadog_permissions.rbac.permissions.orchestration_workload_scaling_write,
      data.datadog_permissions.rbac.permissions.agent_upgrade_write,
      data.datadog_permissions.rbac.permissions.code_analysis_read,
      data.datadog_permissions.rbac.permissions.on_prem_runner_read,
      data.datadog_permissions.rbac.permissions.on_prem_runner_write,
      data.datadog_permissions.rbac.permissions.on_prem_runner_use,
      data.datadog_permissions.rbac.permissions.quality_gates_evaluations_read,
      data.datadog_permissions.rbac.permissions.aws_configurations_manage,
      data.datadog_permissions.rbac.permissions.gcp_configurations_manage,
      data.datadog_permissions.rbac.permissions.azure_configurations_manage,
      data.datadog_permissions.rbac.permissions.aws_configuration_edit,
      data.datadog_permissions.rbac.permissions.azure_configuration_edit,
      data.datadog_permissions.rbac.permissions.gcp_configuration_edit,
      data.datadog_permissions.rbac.permissions.oci_configuration_edit,
      data.datadog_permissions.rbac.permissions.oci_configurations_manage,
      data.datadog_permissions.rbac.permissions.aws_configuration_read,
      data.datadog_permissions.rbac.permissions.azure_configuration_read,
      data.datadog_permissions.rbac.permissions.gcp_configuration_read,
      data.datadog_permissions.rbac.permissions.oci_configuration_read,
    ]
    "read-only-tf" = [
      data.datadog_permissions.rbac.permissions.apm_retention_filter_read,
      data.datadog_permissions.rbac.permissions.apm_service_ingest_read,
      data.datadog_permissions.rbac.permissions.logs_read_archives,
      data.datadog_permissions.rbac.permissions.logs_read_data,
      data.datadog_permissions.rbac.permissions.logs_live_tail,
      data.datadog_permissions.rbac.permissions.logs_read_index_data,
      data.datadog_permissions.rbac.permissions.synthetics_read,
      data.datadog_permissions.rbac.permissions.rum_session_replay_read,
      data.datadog_permissions.rbac.permissions.apm_pipelines_read,
      data.datadog_permissions.rbac.permissions.apm_service_catalog_read,
      data.datadog_permissions.rbac.permissions.watchdog_insights_read,
      data.datadog_permissions.rbac.permissions.appsec_event_rule_read,
      data.datadog_permissions.rbac.permissions.connections_read,
      data.datadog_permissions.rbac.permissions.workflows_read,
      data.datadog_permissions.rbac.permissions.appsec_activation_read,
      data.datadog_permissions.rbac.permissions.appsec_protect_read,
      data.datadog_permissions.rbac.permissions.security_monitoring_cws_agent_rules_read,
      data.datadog_permissions.rbac.permissions.continuous_profiler_read,
      data.datadog_permissions.rbac.permissions.cases_read,
      data.datadog_permissions.rbac.permissions.client_tokens_read,
      data.datadog_permissions.rbac.permissions.cloud_cost_management_read,
      data.datadog_permissions.rbac.permissions.quality_gate_rules_read,
      data.datadog_permissions.rbac.permissions.apm_api_catalog_read,
      data.datadog_permissions.rbac.permissions.continuous_profiler_pgo_read,
      data.datadog_permissions.rbac.permissions.org_connections_read,
      data.datadog_permissions.rbac.permissions.reference_tables_read,
      data.datadog_permissions.rbac.permissions.code_analysis_read,
      data.datadog_permissions.rbac.permissions.on_prem_runner_read,
      data.datadog_permissions.rbac.permissions.quality_gates_evaluations_read
    ]
  }
}

resource "datadog_role" "roles" {
  for_each = local.roles

  name = each.key

  dynamic "permission" {
    for_each = each.value
    content {
      id = permission.value
    }
  }
}